# The ProxyCommand below should always be in the exact same format
# either two spaces before the command, or a hash (comment) followed 
# by two spaces before the command.
#
# This is because the function which switches beteween the Reith Proxy
# and normal internet uses a 'sed' invokation that expects this exact
# format
Host * !*,??-*-?
  ProxyCommand nc -x "socks-gw.reith.bbc.co.uk:1085" -X 5 %h %p

Host github.com 
	AddKeysToAgent yes
	UseKeychain yes
	Identityfile ~/.ssh/id_rsa.github

Host ?.access.*.cloud.bbc.co.uk
	AddKeysToAgent yes
  IdentityFile ~/.ssh/id_rsa.bbc

Host *,??-*-?
	AddKeysToAgent yes
  User ben_wainwright
  IdentityFile ~/.ssh/id_rsa.bbc
  ProxyCommand >&1; h="%h"; r=${h##*,}; i=${h%%,*}; v=$(($(cut -d. -f2 <<<$i) / 32)); exec ssh -q -p 22000 bastion-tunnel@$v.access.$r.cloud.bbc.co.uk nc $i %p
  StrictHostKeyChecking no
  UserKnownHostsFile /dev/null
